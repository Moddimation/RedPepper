<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Project RedPepper: Decompilation of Super Mario 3D Land.">
    <link rel="stylesheet" href="https://prp.moddi.dev/assets/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Reggae+One&disp=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Nunito&disp=swap" rel="stylesheet">
    <link rel="icon" href="https://prp.moddi.dev/assets/favicon.ico" type="image/x-icon">
    <title>File seadQuatCalcCommon.hpp - RedPepper Wiki</title>
  </head>
  <body>
    <div class="container">
      <nav>
        <ul>
        </ul>
      </nav>

      <!--Upper bar-->
      <div id="bar">

          <!--Project text / logo-->
          <a id="barTitle" href="https://prp.moddi.dev/"><b>Project Yasiki</b></a>
          <div style="display: flex; flex-direction: column; align-items: start;">
            
            <!--Both progress badges-->
            <a href="https://github.com/RedPepperDec">
              <img style="padding-top:10px; width: 90px;" src="https://decomp.dev/Moddimation/Yasiki.svg?mode=shield&measure=code&label=Code" alt="Go to github repo">
            </a>
            <a href="https://decomp.dev/RedPepperDec">
              <img style="padding-bottom:0px; width: 123px;" src="https://decomp.dev/Moddimation/Yasiki.svg?mode=shield&measure=functions&label=Progress" alt="Go to progress page">
            </a>
          </div>
          
          <p> </p>
          
          <!--Add each nav head here-->
            <li>
              <button onclick="window.location.href='https://prp.moddi.dev/files/'">Files</button>
            </li>
            <li>
              <button onclick="window.location.href='https://prp.moddi.dev/classes/'">Classes</button>
            </li>
            <li>
              <button onclick="window.location.href='https://prp.moddi.dev/wiki/'">Full Wiki</button>
            </li>
      </div>
      
      <h1 id="file-seadquatcalccommonhpp">File seadQuatCalcCommon.hpp</h1>
<p><a href="../files/"><strong>File List</strong></a> <strong>&gt;</strong> <a href="../dir_f6d5c8d1d4c60cd689fcf859a6687fb0/"><strong>include</strong></a> <strong>&gt;</strong> <a href="../dir_9adfe416bc4f0c29a5cf1f3d542cf0b8/"><strong>math</strong></a> <strong>&gt;</strong> <a href="../seadQuatCalcCommon_8hpp/"><strong>seadQuatCalcCommon.hpp</strong></a></p>
<p><a href="../seadQuatCalcCommon_8hpp/">Go to the documentation of this file</a></p>
<pre><code class="language-C++">#pragma once

#ifndef SEAD_MATH_QUAT_CALC_COMMON_H_
#include &lt;math/seadQuatCalcCommon.h&gt;
#endif

#include &lt;math/seadMathCalcCommon.h&gt;
#include &lt;math/seadQuat.h&gt;

namespace sead {
template &lt;typename T&gt;
inline T QuatCalcCommon&lt;T&gt;::length(const Base&amp; v) {
    return sqrt(dot(v, v));
}

template &lt;typename T&gt;
inline T QuatCalcCommon&lt;T&gt;::normalize(Base&amp; v) {
    const T len = length(v);
    if (len &gt; 0) {
        const T inv_len = 1 / len;
        v.w *= inv_len;
        v.x *= inv_len;
        v.y *= inv_len;
        v.z *= inv_len;
    }

    return len;
}

template &lt;typename T&gt;
inline T QuatCalcCommon&lt;T&gt;::dot(const Base&amp; u, const Base&amp; v) {
    return (u.w * v.w) + (u.x * v.x) + (u.y * v.y) + (u.z * v.z);
}

template &lt;typename T&gt;
inline void QuatCalcCommon&lt;T&gt;::setMul(Base&amp; out, const Base&amp; u, const Base&amp; v) {
    T w = (u.w * v.w) - (u.x * v.x) - (u.y * v.y) - (u.z * v.z);
    T x = (u.w * v.x) + (u.x * v.w) + (u.y * v.z) - (u.z * v.y);
    T y = (u.w * v.y) - (u.x * v.z) + (u.y * v.w) + (u.z * v.x);
    T z = (u.w * v.z) + (u.x * v.y) - (u.y * v.x) + (u.z * v.w);
    out.w = w;
    out.x = x;
    out.y = y;
    out.z = z;
}

/*template &lt;typename T&gt;
inline void QuatCalcCommon&lt;T&gt;::slerpTo(Base&amp; out, const Base&amp; q1, const Base&amp; q2, f32 t)
{
    T dot = (q1.x * q2.x) + (q1.y * q2.y) + (q1.z * q2.z) + (q1.w * q2.w);
    if (dot &gt; 1)
        dot = 1;
    else if (dot &lt; -1)
        dot = -1;

    const T dot_0 = dot;
    if (dot &lt; 0)
        dot = -dot;

    T a, b;
    const T theta_0 = MathCalcCommon&lt;T&gt;::acos(dot);
    const T sin_theta_0 = std::sin(theta_0);
    if (MathCalcCommon&lt;T&gt;::abs(sin_theta_0) &lt; std::numeric_limits&lt;T&gt;::epsilon()) {
        a = 1.0f - t;
        b = t;
    } else {
        const T theta = theta_0 * t;
        const T sin_theta_0_inv = 1.0f / sin_theta_0;
        a = sin_theta_0_inv * std::sin(theta_0 - theta);
        b = sin_theta_0_inv * std::sin(theta);
    }

    if (dot_0 &lt; 0)
        b = -b;

    out.x = a * q1.x + b * q2.x;
    out.y = a * q1.y + b * q2.y;
    out.z = a * q1.z + b * q2.z;
    out.w = a * q1.w + b * q2.w;
}*/

template &lt;typename T&gt;
inline void QuatCalcCommon&lt;T&gt;::makeUnit(Base&amp; q) {
    q = Quat&lt;T&gt;::unit;
}

template &lt;typename T&gt;
inline bool QuatCalcCommon&lt;T&gt;::makeVectorRotation(Base&amp; q, const Vec3&amp; from, const Vec3&amp; to) {
    // Based on The Shortest Arc Quaternion from Game Programming Gems 1
    Vec3 cross;
    Vector3CalcCtr&lt;T&gt;::cross(cross, from, to);
    const T dot = Vector3CalcCtr&lt;T&gt;::dot(from, to) + 1;

    if (dot &lt;= MathCalcCommon&lt;T&gt;::epsilon()) {
        makeUnit(q);
        return false;
    } else {
        T s = MathCalcCommon&lt;T&gt;::sqrt(2 * dot);
        T rs = 1 / s;
        set(q, s * 0.5f, cross.x * rs, cross.y * rs, cross.z * rs);
        return true;
    }
}

template &lt;typename T&gt;
inline void QuatCalcCommon&lt;T&gt;::set(Base&amp; q, T w, T x, T y, T z) {
    q.w = w;
    q.x = x;
    q.y = y;
    q.z = z;
}

template &lt;typename T&gt;
inline void QuatCalcCommon&lt;T&gt;::setRPY(Base&amp; q, T roll, T pitch, T yaw) {
    const T cy = cos(yaw / 2);
    const T cp = cos(pitch / 2);
    const T cr = cos(roll / 2);
    const T sy = sin(yaw / 2);
    const T sp = sin(pitch / 2);
    const T sr = sin(roll / 2);

    const T cy_cp = cy * cp;
    const T sy_sp = sy * sp;
    const T cy_sp = cy * sp;
    const T sy_cp = sy * cp;

    const T w = (cy_cp * cr) + (sy_sp * sr);
    const T x = (cy_cp * sr) - (sy_sp * cr);
    const T y = (cy_sp * cr) + (sy_cp * sr);
    const T z = (sy_cp * cr) - (cy_sp * sr);

    set(q, w, x, y, z);
}

}  // namespace sead
</code></pre>
        <script src="../../search/main.js"></script>
    </div>
  </body>
</html>